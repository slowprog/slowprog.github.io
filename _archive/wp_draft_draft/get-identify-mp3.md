---
layout: post
status: draft
title: Получить метаданные mp3
author:
  display_name: SlowProg
  login: seoadmin
  email: paperplanesu@rambler.ru
  url: http://paperplane.su
author_login: seoadmin
author_email: paperplanesu@rambler.ru
author_url: http://paperplane.su
wordpress_id: 2744
wordpress_url: http://paperplane.su/?p=2744
date: '2013-01-04 02:25:39 +0400'
categories:
- Мастерская
tags: []
comments: []
---
<p>http:&#47;&#47;www.designaeon.com&#47;read-mp3-tags-without-downloading-it&#47;</p>
<p>Так же можно узнать битрейт без скачивания и дополнительных классов если изветна продолжительнсть мелодии. http:&#47;&#47;habrahabr.ru&#47;qa&#47;4659&#47; тут в ответах написано.<br />
Расширения для вконтакта делают так: узнают продолжительность трека (Вконтакт пишет, сколько длится трек), отправляют HEAD запрос на файл (отдаются только заголовки), из ответа на который узнают вес файла в байтах. Ну а дальнейшее дело арифметики &mdash; поделить длину файла на продолжительность. а как узнать размер это из первой статьи, там до применения класса есть код который это узнает.</p>
<p>Иногда создатели различных медиа-сайтов сталкиваются с интересными задачами. Ведь работа с аудио и видео это целая отдельная сфера со своими загвоздками. И сегодня я хочу разобрать одну из них, на мой взгляд, чаще всего встречающуюся на сайтах предоставляющим доступ к музыке и другим аудио-файлам: получение информации об аудио-файле mp3, таких как битрейт, продолжительность, размер, название и др. Все эти метаданные хранятся в формате ID3 (подробней в <a href="http:&#47;&#47;ru.wikipedia.org&#47;wiki&#47;ID3_(метаданные)" target="_blank">вики<&#47;a>).</p>
<p>Я постараюсь показать различные способы при трех различных ситуациях. Ситуации эти отличаются набором начальных данных, которыми вы обладаете о файле:</p>
<ul>
<li>Аудио-файл находится у вас на сервере и вы к нему имеете полный доступ.<&#47;li>
<li>
Аудио-файл находится на другом сервере и вы имеете только ссылку на него.<&#47;li></p>
<li>
Аудио-файл находится на другом сервере, вы имеете на него ссылку и знаете продолжительность, вам нужно узнать размер и битрейт.<&#47;li></p>
<p><&#47;ul><br />
Данные случаи я рассмотрю в статье. Как видите сами, первые два встречаются довольно часто, а третий реже, но не так как вам может показаться. Третий вариант, как правило, бывает при вытягивании музыки с различных сервисов, но обо всем по порядку.</p>
<h2>MP3 со своего сервера<&#47;h2><br />
Данный случай один из самых распространенных и не очень сложных, т.к. анализируемый файл находится под рукой и тянуть его ни от куда не надо. </p>
<p>Для начало нам понадобится библиотека, которая и будет узнавать всю информацию о аудио. Ведь не думали же вы, что мы будем писать велосипед. Подобных библиотек понаписано приличное количество. В данной статье мы будем использовать <a rel="nofollow" href="http:&#47;&#47;getid3.sourceforge.net&#47;" target="_blank">getID3()<&#47;a>, которая на мой взгляд достаточно хороша. Качаем ее по ссылке и продолжаем читать мануал.</p>
<p>Поскольку файл находится у нас на сервере и мы знаем его место расположения, то более нам ничего не требуется и можно легко и просто воспользоваться скаченной библиотекой. На сайте библиотеки можно посмотреть различные демки по ее использованию. Тут я предоставлю один короткий иллюстрирующий ее возможности код:</p>
<p>[cce lang="php"]<br />
&#47;&#47; подключаем библиотеку getID3() (у вас она может быть и в другой директории)<br />
require_once('..&#47;getid3&#47;getid3.php');</p>
<p>&#47;&#47; создаем объект класса getID3<br />
$getID3 = new getID3;</p>
<p>&#47;&#47; адрес анализируемого аудио-файла в файловой системе<br />
$filename = '..&#47;audio&#47;music.mp3';</p>
<p>&#47;&#47; анализируем файл и сохраняем результат в переменную $fileInfo<br />
$fileInfo = $getID3->analyze(filename);</p>
<p>&#47;&#47; выводим необходимые нам данные<br />
echo $fileInfo['comments_html']['artist'][0]; &#47;&#47; исполнитель<br />
echo $fileInfo['tags']['id3v2']['title'][0];  &#47;&#47; название<br />
echo $fileInfo['audio']['bitrate'];           &#47;&#47; битрейт<br />
echo $fileInfo['playtime_string'];            &#47;&#47; продолжительность</p>
<p>&#47;&#47; или выведете весь массив данных сразу на экран<br />
&#47;&#47;echo '
<pre>'.htmlentities(print_r($fileInfo, true)).'<&#47;pre>';<br />
[&#47;cce]<br />
Весь код прокомментирован и не представляет сложности, все просто: подключаем библиотеку, анализируем файл и выводим результат. За остальными примерами вы можете сходить на официальный сайт.</p>
<h2>MP3 с чужого сервера<&#47;h2><br />
Частенько, при выполнении парсинга других сайтов и вытягивания оттуда аудио-файлов, может возникнуть задача получения данных о музыке по ссылке с другого сайта. Притом в данном случае я покажу как узнать методанные mp3 без скачивания, потому что в противном случае достаточно предыдущего пункта.</p>
<h2>Узнать размер и битрейт зная продолжительность<&#47;h2><br />
Этот случай является довольно частным, но тем не менее попадается при парсинге сайтов, когда продолжительность мелодии можно вычленить из содержимого страницы или получить непосредственно от самого сервиса запросом по API или еще как. Не важно. Смысл тот, что продолжительность мелодии должна быть известна и тогда мы сможем узнать размер файла и его битрейт не прибегая к помощи стороннего кода и не подключая никакие библиотеки. Достаточно будет стандартного CURL'а.</p>
