---
layout: post
status: publish
published: true
title: Форма гостевого поста
author:
  display_name: SlowProg
  login: seoadmin
  email: paperplanesu@rambler.ru
  url: http://paperplane.su
author_login: seoadmin
author_email: paperplanesu@rambler.ru
author_url: http://paperplane.su
wordpress_id: 2723
wordpress_url: http://paperplane.su/?p=2723
date: '2013-01-19 05:46:18 +0400'
date_gmt: '2013-01-19 01:46:18 +0400'
categories:
- Без плагина
tags:
- форма
- гость
comments:
- id: 133974
  author: Евгений
  author_email: viewikvip@yandex.ru
  author_url: http://viewik.ru
  date: '2013-01-19 10:05:24 +0400'
  date_gmt: '2013-01-19 06:05:24 +0400'
  content: Спасибо большое, будем пробовать)))
- id: 134017
  author: Роман
  author_email: casio11@yandex.ru
  author_url: http://fishingway.ru/
  date: '2013-01-19 22:18:33 +0400'
  date_gmt: '2013-01-19 18:18:33 +0400'
  content: Добрый вечер! Немного не понял, как правильно применить данную форму? если
    в случае с формой обратной связи под это дело подбирается вся страница, то как
    вызывать гостевую форсу в каждой записи по умолчанию? Может я чего не понял, заранее
    прошу прощения)
- id: 134024
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-01-20 00:27:09 +0400'
  date_gmt: '2013-01-19 20:27:09 +0400'
  content: Зачем вызывать гостевую форму в каждой записи? Данная форма служит для
    того, чтобы человек мог ставить свой гостевой пост, а для этого одной страницы
    достаточно, как у меня, например.
- id: 134085
  author: morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2013-01-20 14:24:18 +0400'
  date_gmt: '2013-01-20 10:24:18 +0400'
  content: А много уже с этой гостевой формы статей отправили?
- id: 134133
  author: Екатерина
  author_email: katrina565@gmail.com
  author_url: http://donturistik.ru
  date: '2013-01-20 23:36:21 +0400'
  date_gmt: '2013-01-20 19:36:21 +0400'
  content: Лично я уже три :)
- id: 134170
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-01-21 07:33:13 +0400'
  date_gmt: '2013-01-21 03:33:13 +0400'
  content: Ну да, Катя основной поставщик гостевых постов xDDD еще вроде один помимо
    катеных есть. Но я пока не сильно популярен xDDDDD Но я на это смотрю так, что
    хуже от этого не будет =)
- id: 134229
  author: Роман
  author_email: casio11@yandex.ru
  author_url: http://fishingway.ru/
  date: '2013-01-21 21:32:34 +0400'
  date_gmt: '2013-01-21 17:32:34 +0400'
  content: не понимаю как форма гостевого поста должна работать? в форме обратной
    связи в параметрах страницы идет ссылка на шаблон формы, а тут каким образом все
    должно работать?
- id: 134235
  author: Артур
  author_email: Internetartur@yandex.ru
  author_url: ''
  date: '2013-01-21 22:38:00 +0400'
  date_gmt: '2013-01-21 18:38:00 +0400'
  content: "Немножко не понятно, что происходит поэтапно со статьёй? Она приходит
    вам на почту, и вы вручную потом вставляете её на сайт, или она в админ понели
    сайта находится и вам остается ее просто одобрить (в случае если она соответствует
    вашим требованиям)?\r\n\r\nИ тут же вопрос, можно ли сделать так, чтобы статьи
    добавлялись на блоге автоматом (типа как в соц сети вебмастеров)?\r\nСпасибо."
- id: 134238
  author: Артур
  author_email: Internetartur@yandex.ru
  author_url: ''
  date: '2013-01-21 22:43:05 +0400'
  date_gmt: '2013-01-21 18:43:05 +0400'
  content: Наверное немножко непонятно я выразился по поводу соц сетей. Я имею ввиду,
    что бы посетитель зашел на ваш блог, оставил гостевой пост, и нажав на кнопку
    "отправить пост", статья сразу же опубликовалась на вашем блоге. Можно так настроить
    ваш КОД?
- id: 134246
  author: Екатерина
  author_email: katrina565@gmail.com
  author_url: http://donturistik.ru
  date: '2013-01-22 00:44:32 +0400'
  date_gmt: '2013-01-21 20:44:32 +0400'
  content: "Если важно не количество, а качество гостевых постов, то однозначно хуже
    не будет :))) SlowProg еще добрый, я вот за размещение гостевого поста 300 р затребовала
    - люди ужОснулись и убежали)))\r\n\r\nВообще, гостевой пост штука своеобразная:
    ты хочешь получить ссылку, за это ты что-то предлагаешь - или деньги, или качественный
    текст.\r\nНа бирже Миралинкс, например, с тебя и деньги берут, и текст качественный
    требуют - но это биржа, там и деньги небольшие, и текст должен быть приличный,
    но не обязательно шедевр - нечто среднее.\r\nВ ситуации же с гостевым постом ты
    должен заинтересовать хозяина площадки суперским текстом. А писать хороший текст
    для кого-то - жаба давит, хороший текст лучше себе, любимому, оставить. Вот и
    нету у нас нормальных гостевых. Разве что в рамках каких-нибудь конкурсов...\r\n\r\nПочему
    я пишу гостевые?\r\n1. Я занимаюсь продвижением собственного сайта и все (ну,
    почти все) о чем идет речь на этом блоге мне не чуждо.\r\n2. тематика моего сайта
    совершенно другая, а высказаться по сайтостроительству и интернетингу иногда хочется.\r\n3.
    Почитаешь какой-нибудь Сабскрайб, а там пишут: где взять тему для статьи? о чем
    писать? как заинтересовать читателя? Я, может, очень нескромная, но у меня таких
    вопросов не возникает. А тем, кто задает такие вопросы я процитирую Льва Толстого:
    \"Можешь не писать - не пиши!\""
- id: 134271
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-01-22 07:51:55 +0400'
  date_gmt: '2013-01-22 03:51:55 +0400'
  content: |-
    Сделать можно, но это уже будет другой немного скрипт, только форма и останется от старого. Я другую идею преследовал. Сразу публиковать это ужас, по моему. Т.к. я обычно возвращаю на доработку, потому что, как было верно замечено, я требую качественный текст. Не скажу, что у меня много гостевых постов, но все что есть удовлетворяют моим требованиям.

    А в общем и целом, сделать такой скрипт можно. Но возникают другие интересные момент. Безопасность. Ведь этот скрипт напрямую дает возможность делать изменения в вашей базе данных любому, кто зайдет на блог. А если найдет кто брешь в обороне WordPress и сможет провести SQL-инъекцию или еще что, то так и блога лишиться не долго. Я на такое пойтить не могу =)
- id: 134319
  author: Артур
  author_email: Internetartur@yandex.ru
  author_url: ''
  date: '2013-01-22 19:21:29 +0400'
  date_gmt: '2013-01-22 15:21:29 +0400'
  content: Я просто хотел сделать что то типа соц сети webice.ru только на WordPress.
    Кстати не знаете какой движек стоит на webice.ru. Это не самопис точно, потому
    что я видел точно такую же соц сеть только с другим дизайном, а так тоже самое,
    просто не помню урл.
- id: 134328
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-01-22 21:01:51 +0400'
  date_gmt: '2013-01-22 17:01:51 +0400'
  content: Да, их как собак нерезаных.  Но на каком движке я не знаю. Вполне могут
    быть все самописными. Самописным даже легче сделать, чем огород городить из костылей
    =))))
- id: 134339
  author: Артур
  author_email: Internetartur@yandex.ru
  author_url: ''
  date: '2013-01-22 23:20:49 +0400'
  date_gmt: '2013-01-22 19:20:49 +0400'
  content: Самописным может и легче, но только когда разбираешься в этом хорошо. А
    так, к примеру зачем делать самописный блог, если есть движок  WordPress, так
    же и в этом случае зачем делать самописную соц сеть, если есть отличный движок
    как например на вешеописанном сайте. Вот только бы узнать его. Буду благодарен
    если что то узнаете))
- id: 134344
  author: Екатерина
  author_email: katrina565@gmail.com
  author_url: http://donturistik.ru
  date: '2013-01-23 00:06:31 +0400'
  date_gmt: '2013-01-22 20:06:31 +0400'
  content: "Несколько совсем юных соцсетей видела вот на этом движке sharetronix.com,
    например http:&#47;&#47;kuk-ku.ru&#47; (да простит меня SlowProg великодушный
    и всемилостивый за ссылку!)\r\nУчитывая, что они плодятся, как грибы, могу предположить,
    что сделать это несложно, а вот раскрутить..."
- id: 134367
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-01-23 07:39:53 +0400'
  date_gmt: '2013-01-23 03:39:53 +0400'
  content: "Хватит меня уже стебать =) Ссылки это хорошо, исходящие тоже неплохо.
    А вообще молодец, что про соц сеть сказала.\r\n\r\nИ если честно, то я как-то
    натыкался на блог похожий на вебайс и автор его мне сказал, что он написан при
    помощи Symfony2. Это не CMS, а фреймворк - надстройка над языком дающая дополнительный
    функционал, т.е. в принципе, это так же написано ручками =)"
- id: 134409
  author: Артур
  author_email: Internetartur@yandex.ru
  author_url: ''
  date: '2013-01-23 18:05:17 +0400'
  date_gmt: '2013-01-23 14:05:17 +0400'
  content: 'Да нее, я нашел смотрите: вебайс  и точно такой же haiter.ru. Две одинаковых
    соц сети, от разных авторов не могут быть самописными. Значит есть определенный  движок.
    И как я нарыл получается что этот движок это DLE.'
- id: 134410
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-01-23 18:19:41 +0400'
  date_gmt: '2013-01-23 14:19:41 +0400'
  content: Да, вроде похоже на правду. DLE подойдет, как впрочем и любой другой =)
    Но нужна ли эта очередная соц сеть для веб-мастером. Или есть какая-то изюминка?
- id: 134431
  author: Артур
  author_email: Internetartur@yandex.ru
  author_url: ''
  date: '2013-01-23 21:15:42 +0400'
  date_gmt: '2013-01-23 17:15:42 +0400'
  content: Есть кое какие интересные мысли, просто я в програмировании не особо силен.
    и времени свободного не особо много...
- id: 134465
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-01-24 02:16:27 +0400'
  date_gmt: '2013-01-23 22:16:27 +0400'
  content: 'Да, понимаю. У меня похожие проблемы: задумок много, а времени мало, катастрофически
    мало!'
- id: 134511
  author: Андрей
  author_email: rubtsov-gel@yandex.ru
  author_url: http://rubtsow.ru/
  date: '2013-01-24 12:37:29 +0400'
  date_gmt: '2013-01-24 08:37:29 +0400'
  content: Подключите плагин BuddyPress к вордпрессу, немного допилите перевод - и
    будет вам счастье в виде соцсети.
- id: 135787
  author: Otshelnik-fm
  author_email: Otshelnik-Fm@yandex.ru
  author_url: http://beoff.ru
  date: '2013-02-04 01:21:16 +0400'
  date_gmt: '2013-02-03 21:21:16 +0400'
  content: SlowProg не сочти за рекламу. http:&#47;&#47;wppost.ru&#47; - парень делает
    интересный модуль для вордпресса - я полагаю он сможет заменить BuddyPress. Уже
    сейчас есть фронтэнд логин и регистрация, карма, личные сообщения (и уведомления
    всплывающие) + создание групп. Всё на аяксе и, естественно, минуя админку - т.е.
    в привычном для сайта дизайне. Сейчас он разрабатывает к нему модуль онлайн магазина.
    В общем мощный комбайн получается. Ну и предлагаю подключиться к тестированию
    -т.к. создаётся уникальный и мощный инструмент для вордпресса
- id: 135788
  author: Андрей
  author_email: rubtsov-gel@yandex.ru
  author_url: http://rubtsow.ru/
  date: '2013-02-04 01:33:42 +0400'
  date_gmt: '2013-02-03 21:33:42 +0400'
  content: Я не SlowProg.
- id: 135790
  author: Otshelnik-fm
  author_email: Otshelnik-Fm@yandex.ru
  author_url: http://beoff.ru
  date: '2013-02-04 01:39:46 +0400'
  date_gmt: '2013-02-03 21:39:46 +0400'
  content: Это я знаю. просто вам дал ссылку на новый плагин вместо BuddyPressа, и
    заодно извинился перед хозяином сайта за ссылку
- id: 135812
  author: Андрей
  author_email: rubtsov-gel@yandex.ru
  author_url: http://rubtsow.ru
  date: '2013-02-04 03:53:03 +0400'
  date_gmt: '2013-02-03 23:53:03 +0400'
  content: Спасибо агромЕннейшее. Не помню, правда, чтобы я писал о том, что пользуюсь
    BuddyPress-ом или просил ссылку на плагин того же типа.
- id: 136567
  author: Morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2013-02-09 02:29:29 +0400'
  date_gmt: '2013-02-08 22:29:29 +0400'
  content: Ооо, не думал, что такое (функциональность, в смысле) может кому-то понадобиться
    :)
- id: 136568
  author: Morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2013-02-09 02:30:23 +0400'
  date_gmt: '2013-02-08 22:30:23 +0400'
  content: Блин, только сейчас обнаружил в спаме уведомления... А мог бы вообще не
    заметить.
- id: 136572
  author: Morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2013-02-09 02:41:39 +0400'
  date_gmt: '2013-02-08 22:41:39 +0400'
  content: Сайт ваш хоть и не сайтостроительский, но только взглянув на sitemap.xml
    я уже увидел нечто новое и прокачался :)
- id: 136623
  author: Екатерина
  author_email: katrina565@gmail.com
  author_url: http://donturistik.ru
  date: '2013-02-09 12:13:43 +0400'
  date_gmt: '2013-02-09 08:13:43 +0400'
  content: "Ух ты! Пошла взглянуть на свой sitemap.xml и чуть со стула не упала! Не
    знаю, что там увидели Вы, а я увидела, что там нет статей за последние 8 месяцев!!!\r\nИ
    как такое может быть???"
- id: 136625
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-02-09 12:19:35 +0400'
  date_gmt: '2013-02-09 08:19:35 +0400'
  content: Ну на сама деле, да, функционал не самый полезный. И он выполняет больше
    рекламную задачу (типа, смотрите я гостевые посты принимаю), но при этом он и
    работать должен =)
- id: 136647
  author: Morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2013-02-09 16:18:35 +0400'
  date_gmt: '2013-02-09 12:18:35 +0400'
  content: ''
- id: 136648
  author: Morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2013-02-09 16:19:39 +0400'
  date_gmt: '2013-02-09 12:19:39 +0400'
  content: глюк был, короче говоря :)
- id: 136649
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-02-09 16:20:33 +0400'
  date_gmt: '2013-02-09 12:20:33 +0400'
  content: Так так! Почему прошел пустой коммент? Какие были обстоятельства? Что вводил?
- id: 136651
  author: Morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2013-02-09 16:26:41 +0400'
  date_gmt: '2013-02-09 12:26:41 +0400'
  content: "Кодировки похеренные на странице увидел, проверил в паре браузеров, сделал
    скрин и отправил ссылку - http:&#47;&#47;d.pr&#47;i&#47;bwjW\r\nНо комментарий
    получился пустой, а кодировка восстановилась"
- id: 136652
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-02-09 16:28:48 +0400'
  date_gmt: '2013-02-09 12:28:48 +0400'
  content: Вот вот! мне тоже уже сказали, что кодировка побилась. Но я так ничего
    и не обнаружил! У меня езде норм в разных браузерах. Теперь везде снова нормально???
    Может хостер чего намутил =(
- id: 136660
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-02-09 17:58:44 +0400'
  date_gmt: '2013-02-09 13:58:44 +0400'
  content: Я разобрался в чём была проблема. Ничего серьезного =)
- id: 136666
  author: Otshelnik-fm
  author_email: Otshelnik-Fm@yandex.ru
  author_url: http://beoff.ru
  date: '2013-02-09 18:42:12 +0400'
  date_gmt: '2013-02-09 14:42:12 +0400'
  content: "Теперь тут 2 инопланетянина :)\r\n\r\nЯ вот не понимаю, а просто письмо
    отправить сложно? Зачем какие-то формы, которые тоже самое и делают?\r\n\r\nНа
    своём сайте я не определился - нужна ли мне форма обратной связи в контактах,
    которая отсылает письмо на мыло... Ведь это мыло и так указано в контактах.\r\n\r\nПлюсы
    таких фишек подскажете SlowProg? Или это лень человеческая? Хотя если очень хотят
    и просто мыло отправят. А зачем нам ленивые пользователи? Вот и философствую уже
    над этим вопросом несколько недель. \r\n\r\nДругое дело еслиб эта форма бомбила
    сразу в админку и бд. Есть спец плагины для этого, и вроде бы никто не ругался
    что они небезопасны"
- id: 136670
  author: Екатерина
  author_email: katrina565@gmail.com
  author_url: http://donturistik.ru
  date: '2013-02-09 19:15:27 +0400'
  date_gmt: '2013-02-09 15:15:27 +0400'
  content: "Я думаю, что SlowProg прав - функции рекламные, плюс это облегчает жизнь
    потенциальному \"постодателю\" - не нужно связываться с админом и спрашивать,
    а не примите ли вы мой гостевой пост? Сразу все ясно и понятно - присылайте пост
    через форму, и если все ок, я его размещу с обратной ссылкой.\r\nСчитаю, что подход
    правильный, т.к. в другом случае с приглашением написать гостевой вам придется
    сделать отдельный пост, и не факт, что кто-то его найдет среди прочих."
- id: 136694
  author: Otshelnik-fm
  author_email: Otshelnik-Fm@yandex.ru
  author_url: http://beoff.ru
  date: '2013-02-09 22:38:14 +0400'
  date_gmt: '2013-02-09 18:38:14 +0400'
  content: "Это правильный подход, но костыльный. т.к. создает гемор с форматированием
    и переносом из обычной почты в бд ручками...\r\n\r\nВот еслиб он попадал в бд
    и в админке с ним можно было работать - то огромный плюс. Но может еще этот код
    и эволюционирует в такую штуку"
- id: 143341
  author: V_Koktebel
  author_email: admin77@bigmir.net
  author_url: http://v-koktebel.ru
  date: '2013-04-04 23:09:33 +0400'
  date_gmt: '2013-04-04 19:09:33 +0400'
  content: SlowProg, благодарю за форму. Сейчас пытаюсь себе поставить. Подскажите,
    как в предложенном вами коде (строки 62-63) вставить созданную мною папку и прописать
    путь к ней для  загрузки изображений из формы.
- id: 143344
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-04-04 23:54:06 +0400'
  date_gmt: '2013-04-04 19:54:06 +0400'
  content: Как-то сложно конкретно ответить на вопрос. Просто меняете один адрес на
    другой =) Можете убрать константу WP_CONTENT_DIR  если она вас смущает и писать
    абсолютный пусть если его знаете. Вы скажите, где вы создали папку и тогда я вам
    конкретнее укажу как поменять.
- id: 143346
  author: V_Koktebel
  author_email: admin77@bigmir.net
  author_url: http://v-koktebel.ru
  date: '2013-04-05 00:30:36 +0400'
  date_gmt: '2013-04-04 20:30:36 +0400'
  content: Я создал папку в wp-content&#47;uploads&#47;kartinki&#47;   папка "kartinki"  и  права
    на папку выставил 777 (или зря я так с правами, может и не надо было?)
- id: 143348
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-04-05 00:45:58 +0400'
  date_gmt: '2013-04-04 20:45:58 +0400'
  content: "Тогда так:\r\n<code>WP_CONTENT_DIR .'&#47;uploads&#47;kartinki&#47;'.basename($_FILES['file']['name'])<&#47;code>\r\nНу
    777 наверно излишне, всё зависит от того кому принадлежит папка и кто в неё закачивает
    файлы. В смысле пользователи. Но что-то мне подсказывает, что в вашем случае проканает
    и 755 =) \r\n\r\nPS: Плюс ещё почитайте про <a href=\"http:&#47;&#47;ru.wikipedia.org&#47;wiki&#47;%D0%9C%D0%B5%D0%B6%D1%81%D0%B0%D0%B9%D1%82%D0%BE%D0%B2%D1%8B%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%B8%D0%BD%D0%B3\"
    rel=\"nofollow\">XSS<&#47;a>. Это так, для общего развития. Просто открывая папку
    для загрузок сразу открываешь возможность XSS-атакам. Почитайте, посмотрите, так
    на будущее =))))"
- id: 143350
  author: V_Koktebel
  author_email: admin77@bigmir.net
  author_url: http://v-koktebel.ru
  date: '2013-04-05 00:50:03 +0400'
  date_gmt: '2013-04-04 20:50:03 +0400'
  content: "Скажите, плагин Anti-XSS attack поможет с XSS-атаками? \r\nИли лучше на
    ваш взгляд вообще не открывать папку для загрузок. Указать адрес на внешний хостинг
    хранилища картинок."
- id: 143351
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-04-05 00:54:57 +0400'
  date_gmt: '2013-04-04 20:54:57 +0400'
  content: Честно, не знаю. Не пробовал. На самом деле можете об этом не волноваться,
    шанс что вас будут пробовать на XSS крайне мал т.к., я думаю, у вас не очень крупный
    проект, чтбы кому-то насолить или что-то вроде того. Я просто сказал, чтобы вы
    знали об этом и в случае чего приняли меры. Но особо боятся не стоит.
- id: 143352
  author: V_Koktebel
  author_email: admin77@bigmir.net
  author_url: http://v-koktebel.ru
  date: '2013-04-05 00:57:16 +0400'
  date_gmt: '2013-04-04 20:57:16 +0400'
  content: Спасибо за ответы. Сейчас изменил код,  и проверил залить картинку с формы.
    Почему-то папка осталась пустой. Может что  не так делаю?
- id: 143415
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-04-05 12:32:54 +0400'
  date_gmt: '2013-04-05 08:32:54 +0400'
  content: Мой косяк. Кое-что поправил в форме. Попробуйте сейчас скопировать код
    и опробовать его. Добавил атрибут enctype="multipart&#47;form-data" к форме и
    в загрузке в 62 строке не то значение из массива бралось. Теперь должно быть норм,
    конечно если у вас с хостингом всё нормально =)
- id: 143445
  author: V_Koktebel
  author_email: admin77@bigmir.net
  author_url: http://v-koktebel.ru
  date: '2013-04-05 17:43:32 +0400'
  date_gmt: '2013-04-05 13:43:32 +0400'
  content: Скопировал код, только адрес почты на свой заменил. Теперь ничего не приходит
    на почту, и картинка тоже.
- id: 143448
  author: V_Koktebel
  author_email: admin77@bigmir.net
  author_url: http://v-koktebel.ru
  date: '2013-04-05 18:06:29 +0400'
  date_gmt: '2013-04-05 14:06:29 +0400'
  content: SlowProg, если не против - я обращусь к вам с помощью формы обрат. связи.
- id: 250776
  author: Наталия
  author_email: zavyalova-nataliya@yandex.ru
  author_url: ''
  date: '2015-05-26 21:07:47 +0300'
  date_gmt: '2015-05-26 17:07:47 +0300'
  content: А как разрешить вложение фалов .doc (docx), .pdf и .txt ?
---
<p><a href="http:&#47;&#47;image.paperplane.su&#47;2013&#47;01&#47;guest-form.png"><img src="http:&#47;&#47;image.paperplane.su&#47;2013&#47;01&#47;guest-form-300x300.png" alt="Форма гостевого поста" title="Форма гостевого поста" width="300" height="300" class="alignleft size-medium wp-image-2755" &#47;><&#47;a>Относительно недавно меня попросили рассказать о том, как у меня сделана форма отправки гостевого поста. На удивление собеседника, не был использован плагин или нечто подобное. Всё делалось своими ручками. С этой подачи я и решил написать этот пост о создании формы гостевого поста без плагина для WordPress, хотя сам по себе код формы подойдет для любого движка с небольшими корректировками. </p>
<p>Для начала, я немного расскажу для чего эта форма вообще нужна. Вообще, данный прием в блоге будет полезен и для читателей и для администрации, т.к. читатели смогут публиковать ссылки на целевой сайт с уважаемого и высоко ранжируемого блога, тем самым повышая пузомерки целевого сайта и привлекая на него дополнительный трафик. В свою очередь для администрации это дополнительный контент и услуга для свои пользователей. Главное помнить о том, что имеет смысл принимать на публикацию гостевые посты тогда и только тогда когда ваш блог может быть в чем-то лучше других, например, не нулевые пузомерки или большая посещаемость.  </p>
<p>Некоторое время назад я написал пост, где описал создание <a href="http:&#47;&#47;paperplane.su&#47;feedback-wordpress&#47;" title="Форма обратной связи в WordPress" target="_blank">формы обратной связи<&#47;a> для WordPress без плагина. По сути, это очень похожая задача, потому я не буду вдаваться в подробности и отправлю вас за ними в пост по ссылке выше. А тут вы увидите конкретно код и небольшие пояснения к нему.</p>
<p>Для создания формы гостевого поста необходимо будет создать индивидуальный шаблон для этой страницы. Как это делать читайте в статье про контактную форму. В конечном итоге ваш файл индивидуального шаблона должен содержать примерно следующий код (с поправкой на верстку вашего шаблона):</p>
<p>[cce lang="php"]<br />
<?php<br />
&#47;*<br />
Template Name: Guest<br />
*&#47;<br />
?></p>
<p><?php<br />
if(isset($_POST['submitted'])) {<br />
	if($_POST['comments2'] != '') {<br />
		die("Get out!");<br />
	}</p>
<p>	if(trim($_POST['contactName']) === '') {<br />
		$nameError = 'Пожалуйста, введите ваше имя.';<br />
		$hasError = true;<br />
	} else {<br />
		$name = trim($_POST['contactName']);<br />
	}</p>
<p>	if(trim($_POST['email']) === '')  {<br />
		$emailError = 'Пожалуйста, введите адрес вашей электронной почты.';<br />
		$hasError = true;<br />
	} else if (!preg_match("&#47;^[[:alnum:]][a-z0-9_.-]*@[a-z0-9.-]+\.[a-z]{2,4}$&#47;i", trim($_POST['email']))) {<br />
		$emailError = 'Адрес электронной почты некорректный.';<br />
		$hasError = true;<br />
	} else {<br />
		$email = trim($_POST['email']);<br />
	}</p>
<p>	if(trim($_POST['site']) === '') {<br />
		$site = '';<br />
	} else {<br />
		$site = trim($_POST['site']);<br />
	}</p>
<p>	if(trim($_POST['subject']) === '') {<br />
		$subject = 'Гостевой пост с сайта';<br />
	} else {<br />
		$subject = stripslashes(trim($_POST['subject']));<br />
	}</p>
<p>	if(trim($_POST['comments']) === '') {<br />
		$commentError = 'Пожалуйста, введите текст поста.';<br />
		$hasError = true;<br />
	} else {<br />
		$comments = stripslashes(trim($_POST['comments']));<br />
	}</p>
<p>	if ($_FILES['file']['name']!='')<br />
	{<br />
		$types=array('','.gif','.jpg','.png');<br />
		$news=$_FILES['file'];<br />
		$gis=getimagesize($news['tmp_name']);<br />
		if (($gis[2]>=1)and ($gis[2]<=3))&#47;&#47;здесь проверяем что это файл с расширением gif.jpg,png<br />
		{<br />
			if ($ava['size']<100000)  &#47;&#47;здесь размер файла проверяется<br />
			{ </p>
<p>				if (($gis[0]>10 and $gis[0]<2000) and ($gis[1]>10 and $gis[1]<2000))&#47;&#47;здесь проверяется размер сторон изображения<br />
					{   </p>
<p>						move_uploaded_file($_FILES["file"]["tmp_name"],WP_CONTENT_DIR .'&#47;uploads&#47;'.basename($_FILES['file']['name']));<br />
						$file = array(WP_CONTENT_DIR ."&#47;uploads&#47;".$_FILES["file"]["name"]);</p>
<p>					}<br />
					else<br />
					{<br />
						$commentError = 'Неверный размер у сторон изображения. Нужно не больше 2000х2000 пикселей.';<br />
						$hasError = true;<br />
					}<br />
				}<br />
				else<br />
				{<br />
					$commentError = 'Изображение слишком тяжолое. Нужно не больше 100000 байт!';<br />
					$hasError = true;<br />
				}<br />
		}<br />
		else<br />
		{<br />
			$commentError = 'Неверный формат изображения. Можно только .gif, .jpg, .png';<br />
			$hasError = true;<br />
		}</p>
<p>	} else {<br />
		$file = '';<br />
	}</p>
<p>	if(!isset($hasError)) {<br />
      		$emailTo = get_option('tz_email');<br />
		if (!isset($emailTo) || ($emailTo == '') ){<br />
			$emailTo = get_option('admin_email');<br />
		}<br />
		&#47;&#47; тут можно железно установить почту для отправки письма, например так:<br />
		&#47;&#47; $emailTo = 'admin@site.ru';<br />
		$body = "Имя: $name \n\nEmail: $email \n\nSite: $site \n\nЗаголовок: $subject \n\nПост:\n\n $comments";<br />
		$headers = 'From: '.$name.' <'.$emailTo.'>' . "\r\n" . 'Reply-To: ' . $email;</p>
<p>		wp_mail($emailTo, $subject, $body, $headers, $file);<br />
		$emailSent = true;<br />
		unset($_POST);<br />
	}</p>
<p>} ?></p>
<p><?php get_header(); ?></p>
<div id="content">
<div class="post">
		<?php if (have_posts()) : while (have_posts()) : the_post(); ?></p>
<div class="page" id="post-<?php the_ID(); ?>"></p>
<div class="entry entry_page">
				<?php if(isset($emailSent) && $emailSent == true) { ?></p>
<div class="thanks">
<p>Спасибо за ваш пост. Я постараюсь как можно скорее рассмотреть его.<&#47;p><br />
					<&#47;div><br />
				<?php } else { ?><br />
					<?php the_content(); ?><br />
					<?php if(isset($hasError)) { ?></p>
<p class="error">Извините, но отправить письмо не удалось. Возможно вы допустили ошибки при заполнении формы.
<p>
					<?php } ?><br />
				<?php } ?></p>
<form action="<?php the_permalink(); ?>" id="contactForm" method="post" enctype="multipart&#47;form-data"></p>
<p>Имя автора (обязательно):<br &#47;><br />
						<input type="text" name="contactName" id="contactName" class="required" value="<?php if(isset($_POST['contactName'])) echo $_POST['contactName'];?>" &#47;><br />
						<?php if($nameError != '') { ?><br />
							<span class="error"><?=$nameError;?><&#47;span><br />
						<?php } ?><br />
					<&#47;p></p>
<p>E-Mail автора (обязательно):<br &#47;><br />
						<input type="text" name="email" id="email" class="required email" value="<?php if(isset($_POST['email']))  echo $_POST['email'];?>" &#47;><br />
						<?php if($emailError != '') { ?><br />
							<span class="error"><?=$emailError;?><&#47;span><br />
						<?php } ?><br />
					<&#47;p></p>
<p>Сайт автора:<br &#47;><br />
						<input type="text" name="subject" id="subject" value="<?php if(isset($_POST['subject']))  echo $_POST['subject'];?>" &#47;><br />
					<&#47;p></p>
<p>Заголовок поста:<br &#47;><br />
						<input type="text" name="subject" id="subject" value="<?php if(isset($_POST['subject']))  echo $_POST['subject'];?>" &#47;><br />
					<&#47;p></p>
<p>Содержимое поста (обязательно):<br &#47;></p>
<p>						<textarea name="comments2" id="commentsText2" rows="20" cols="30" class="required"><&#47;textarea><br />
						<script><br />
							window.onload = function(){<br />
								&#47;&#47;document.getElementById('commentsText1').style.display ='none';<br />
								document.getElementById('commentsText2').style.display ='none';<br />
							}<br />
						<&#47;script></p>
<p>						<textarea name="comments" id="commentsText" rows="20" cols="30" class="required"><?php if(isset($_POST['comments'])) { if(function_exists('stripslashes')) { echo stripslashes($_POST['comments']); } else { echo $_POST['comments']; } } ?><&#47;textarea><br />
						<?php if($commentError != '') { ?><br />
							<span class="error"><?=$commentError;?><&#47;span><br />
						<?php } ?><br />
					<&#47;p></p>
<p><input type="file" name="file"><&#47;p><br />
					<input type="submit" class="button" value="Отправить пост"&#47;><br />
					<input type="hidden" name="submitted" id="submitted" value="true" &#47;><br />
				<&#47;form><br />
			<&#47;div><br />
		<&#47;div><br />
		<?php endwhile; endif; ?><br />
	<&#47;div><br />
<&#47;div></p>
<p><?php get_sidebar(); ?><br />
<?php get_footer(); ?><br />
[&#47;cce]</p>
<p>Этот код уже содержит в себе саму форму, обработку данных от этой формы и обманку для глупых спам-ботов. По сути вы можете вставить этот код к себе и всё будет работать, но скорее всего выглядеть оно будет не очень. Для этого вам придется переделать вёрстку этого индивидуального шаблона под свою, ведь я использовал минимальную стандартную вёрстку, которая далеко не везде встречается. Так же предоставляю css-стили, которые используются в этом шаблоне для отображения:<br />
[cce lang="css"]<br />
#contactName{<br />
width:100%;<br />
}<br />
#email{<br />
width:100%;<br />
}<br />
#subject{<br />
width:100%;<br />
}<br />
#commentsText{<br />
width:100%;<br />
}<br />
[&#47;cce]<br />
Если честно, то тут только поля ввода растягиваются на всю ширину и всё. Дальнейшее приукрашивание формы уже лежит на вашей совести.</p>
<p>Да, и кстати, если вы захотите разместить какой-нибудь сопровождающий форму текст, то нужно его просто вбить в форме редактирования страницы (там где и индивидуальный шаблон выбирается). Весь написанный на странице текст отобразится перед формой.</p>
<blockquote><p>
Любая помощь по данному коду (вопросы, установка, доработка и т.д.)<strong> являются платными услугами<&#47;strong>. Пишите через форму обратной связи, если готовы оплатить мою работу. Если вопрос нет, то берём и устанавливаем &ndash; благо, я всё дал и разжевал.<br />
<&#47;blockquote></p>
<p>На этому у меня всё, еще раз повторюсь, что за дополнительной информацией обращайтесь в статью про форму обратной связи (ссылка сверху). Вопросы и предложения в комментарии, пожалуйста. Всем удачи.</p>
