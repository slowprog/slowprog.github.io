---
layout: post
status: publish
published: true
title: WordPress - нагрузка на сервер
author:
  display_name: SlowProg
  login: seoadmin
  email: paperplanesu@rambler.ru
  url: http://paperplane.su
author_login: seoadmin
author_email: paperplanesu@rambler.ru
author_url: http://paperplane.su
wordpress_id: 2382
wordpress_url: http://paperplane.su/?p=2382
date: '2012-05-21 02:56:31 +0400'
date_gmt: '2012-05-20 22:56:31 +0400'
categories:
- Оптимизация
tags:
- шаблоны
- снижение нагрузки
- спам
- плагины
comments:
- id: 47499
  author: Александр
  author_email: pritsas878@gmail.com
  author_url: http://1-infobiznes.ru
  date: '2012-05-22 20:09:08 +0400'
  date_gmt: '2012-05-22 16:09:08 +0400'
  content: 'Советы нужные, однозначно. Как сказано в статье, это дело не одного дня.
    У меня есть один совет по уменьшению объема сайта: иногда на нашем сайте, если
    он не новичок, хранятся картинки в галерее или в библиотеке файлов, стоит эти
    картинки просто удалить. Вес сайта уменьшается.'
- id: 47500
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2012-05-22 20:12:38 +0400'
  date_gmt: '2012-05-22 16:12:38 +0400'
  content: Ну если эти картинки нигде не используются, то да. Но обычно в медиафайлах
    нужные картинки загруженные специально для постов. Или я вас неправильно понял
    =)
- id: 47503
  author: Александр
  author_email: pritsas878@gmail.com
  author_url: http://1-infobiznes.ru
  date: '2012-05-22 20:34:05 +0400'
  date_gmt: '2012-05-22 16:34:05 +0400'
  content: Вы правильно поняли, комментарий отправил, добавить забыл. Бывают ситуации,
    что статьи убираешь, другую ревизию проводишь, а картинки остаются не использованы
    постами. У меня такая ситуация была после года ведения сайта Бухучет для чайников.
    Открыл Все записи, прошелся, то черновик висит, то статья отключена, была актуальна,
    написал новую, старую отключил, картинка висит. Но надо следить, чтобы не удалить
    нужную, а то маленький квадратик останется, вместо картинки. Хостинг пространство
    лимитирует, пришлось удалять лишнее.
- id: 47505
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2012-05-22 20:43:12 +0400'
  date_gmt: '2012-05-22 16:43:12 +0400'
  content: А! Тогда понятно! Ну да, как вариант высвобождения места можно пройтись
    по всем картинкам и найти неиспользуемые. Хотя можно написать код, который будет
    проверять каждую картинку и если она не приаттачена, то удалять, а если она приаттачена,
    но статья к которой она приаттачена отключена, то тоже удалять. Или что-то вроде
    того. Хотя это сомнительно, попадание не 100% потому вручную будет надежнее =)
- id: 124761
  author: Как увеличить посещаемость сайта? | Заработок в интернете, работа в интернете
  author_email: ''
  author_url: http://vpelin-blog.ru/nachinayushhim/s-sajtom/kak-uvelichit-poseshhaemost-sajta.html
  date: '2012-11-28 19:36:55 +0400'
  date_gmt: '2012-11-28 15:36:55 +0400'
  content: "[...] подробной информации я попал на один хороший сайт Сео-тематики и
    задал несколько вопросов его автору, который [...]"
- id: 166872
  author: Валерий
  author_email: purichvalera@gmail.com
  author_url: http://purichvalera.com
  date: '2013-06-13 14:56:09 +0400'
  date_gmt: '2013-06-13 10:56:09 +0400'
  content: "У меня в данный момент такая проблема. Хостинг таймвеб перекинул мой аккаунт
    на резервный сервер и предупредил, чтобы я устранил проблему нагрузки на сервер.
    Я в этом не силен, хоть и прочитал вашу статью. Кто мне может помочь. Идти на
    биржу фрилансеров или вы можете что-то подсказать более толковое?\r\nЯ закинул
    пару дней назад скрипт в функции темы - ТОП комментаторов. Могло ли это создать
    эту проблему с хостером? В один вечер было много комментариев на мой блог и на
    другой день пришло предупреждение от хостинга, но рост посещаемости все равно
    в пределах моей нормы."
- id: 166879
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-06-13 15:04:25 +0400'
  date_gmt: '2013-06-13 11:04:25 +0400'
  content: "Сам по себе этот код такого вызвать не мог. \r\n\r\nА что на счёт спамеров?
    Скачка по спам-комментам не наблюдалось?\r\n\r\nПлюс может быть вас DDoS'или тем
    самым поднимая нагрузку. Или ваш сервер уже дедосил через вас. \r\n\r\nНо так
    или иначе у таймвеба какие-то претензии к вам? Они выставили какие-то требования,
    рекомендации, пожелания? Или они как-то охарактеризовали проблему?"
- id: 167333
  author: Валерий
  author_email: purichvalera@gmail.com
  author_url: http://purichvalera.com
  date: '2013-06-15 09:05:04 +0400'
  date_gmt: '2013-06-15 05:05:04 +0400'
  content: "Спам-комменты в пределах нормы 5-10 в течении суток. На счет ДОС такого
    не было ни разу. За эти дни нагрузка с пика в 268 упала на 12 ,что в пределах
    нормы - можно до 50, согласно пакету, а сегодня глянул на хостинге - 53, чуть
    выше нормы. Прыгает чего-то, хоть на сайте ничего особого не совершается. Все
    в пределах нормы. Не знаю, что это может быть.\r\nМожет хостинг балуется?"
- id: 167342
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-06-15 11:00:20 +0400'
  date_gmt: '2013-06-15 07:00:20 +0400'
  content: "Вас могли дедосить ранее. Или вы могли дедосить кого. Или вы имеете в
    виду что нагрузка на тот момент (когда вас забраковали) была нормальной?\n\nИ
    таймвеб не чем не объяснил свои претензии? никакими цифрами и статистикой не подпёр?
    Если нет, то потребуйте объяснений что не так, и что вы можете сделать для улучшения
    ситуации. Нельзя же на кофейной гуще гадать.\n\nНо может это и сам хостинг. Типа
    у них сервер перестал держать это количество шаред-хостингов и часть из них решили
    перенести на другой сервер. Но это тоже нужно сообщать пользователям, что мол
    вас переносят потому что мы облажались, извините. \n\nВ общем, в любом случае,
    за комментариями к хостеру. Даже если нагрузку делал какой-то конкретный скрипт,
    то они тоже могут это указать ну или хотя бы ткнуть в какую сторону копать."
- id: 169210
  author: Дарья
  author_email: novoe@menunedeli.ru
  author_url: ''
  date: '2013-06-27 15:48:50 +0400'
  date_gmt: '2013-06-27 11:48:50 +0400'
  content: Здравствуйте! А Вы оказываете услуги по оптимизации сайтов для снижения
    наргузки на сервер? Если да, буду рада к Вам обратиться. Мой е-мейл и сайт указаны.
    Сайт на Вордпресс, посещаемость 12-14 тыс уников, часто лежит от перегрузки :(
- id: 174667
  author: Светлана
  author_email: kosenkova-ea@yandex.ru
  author_url: http://sovettebe.ru/
  date: '2013-07-18 12:16:00 +0400'
  date_gmt: '2013-07-18 08:16:00 +0400'
  content: "Здравствуйте! У меня также проблемы с хостингом Таймвеб. Мой сайт превышает
    нагрузку. Конкретно они ничего не сообщают: \r\nСтатистически, рост нагрузки чаще
    всего возникает по одной из следующих причин:\r\n1) рост посещаемости;\r\n2) использование
    неоптимизированных скриптов;\r\n3) отключение кеширования;\r\n4) действие вредоносного
    кода;\r\n5) нежелательная активность поисковых или иных ботов;\r\n6) увеличение
    объёма обрабатываемых данных.\r\n\r\nИзучила ваши статьи по оптимизации. Всё что
    смогла сделала. Поскольку я полный чайник, всё побоялась. \r\n\r\nВ результате
    размер БД уменьшился с 68,61 Мб до 13,12 Мб, дисковая квота с 460 до 404&#47;
    из 4000 Мб. \r\n\r\nПосещаемость на летнее время снизилась с 3500 до 2700, сейчас
    я ничего не пишу. А нагрузка сохраняется, причём скачками. Вчера, например, была
    104 cp (положено до 50 cp).\r\nУже не знаю что и делать. Может быть подскажите
    в какую сторону копать.\r\nЯ установила плагин W3 Total Cache, правильно ли я
    сделала, что удалила плагин wp minify."
- id: 174668
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2013-07-18 12:38:32 +0400'
  date_gmt: '2013-07-18 08:38:32 +0400'
  content: |-
    <blockquote>Посещаемость на летнее время снизилась с 3500 до 2700...<&#47;blockquote>
    Это вы указали уникумов, я так понимаю, но разное количество уникумов может генерировать одно и тоже количество просмотров. Думаю вы поняли куда я клоню, именно по этом нагрузка могла не снизиться.

    На счёт плагина, то W3 Total Cache включает в себя WP-Minify. Так что в этом смысле всё норм. Но скорее всего та же задача минимизации CSS и JS работает не в полную силу. Лично я ещё не встречал плагин, который может сам собрать все CSS и JS и в нужном месте подгружать только нужные минимизированные файлы. Обычно я делаю это вручную. И это относительно рутинная и сложная задача. На пальцах не объяснишь. Но у вас с этим всё более менее, да JS было бы неплохо вручную скомпоновать, но можно и обойтись.

    А все причины, что вы указали, были вами обработаны? Например, исключили вы пункты 4, 5?

    И ещё, как запасной вариант могу посоветовать MaxCache (погуглите и найдёте), это плагин, который кеширует по полной программе. У него конечно есть минусы и он платный, но как вы его установите о нагрузке (на какое-то время) вы точно забудете. Хотя он мне не очень нравится, но в вашем случае поможет.

    И вообще, может пришло время перейти на VPS? Может просто ваш хостинг не способен большее потянуть?
- id: 174678
  author: Светлана
  author_email: kosenkova-ea@yandex.ru
  author_url: http://sovettebe.ru/
  date: '2013-07-18 14:36:40 +0400'
  date_gmt: '2013-07-18 10:36:40 +0400'
  content: "Просмотров у меня конечно больше, чем поситителей, но ненамного, например
    вчера 2686 и 3873. Это на вашем я сайте сижу и копаюсь уже две недели, как и другие,
    которым нужны знания.  \r\nЧто касается пунктов:\r\n2. честно говоря, не могу
    сказать какие у меня скрипты оптимизированные или нет.\r\n4. по поводу вредоносного
    кода - вебмастер яндекса вредоносного кода не обнаружил и вебмастер google сообщает:
    Вредоносные программы на этом сайте не обнаружены. Другим способом не знаю как
    определить.\r\nСпам-комментариев у меня немного - 4-5 в день.\r\n\r\nУ меня раньше
    стоял плагин Akismet. Потом я поставила Antispam Bee, сейчас стоит Invisible Captcha.
    Вы по прежнему считаете Antispam Bee лучшим и нужно ли удалять деактивированные
    плагины или он не мешают работе?\r\n\r\n5. по поводу ботов: вставила в robots.txt
    исключения для роботов bingbot,  Slurp,  msnbot и  в файле  .htaccess прописала
    блокировку доступа к сайту ботам по их именам - большой список.\r\n\r\nПо поводу
    VPS ничего не могу сказать, поскольку ничего об этом не знаю. Не подскажите, где
    можно об этом почитать? Меня устраивает наш хостинг. Он достаточно надежный, сайт
    работает стабильно. Но из-за скачков нагрузки они предлагают нам перейти на очень
    дорогие тарифы, которые нам не подходят.\r\n\r\nЕщё подсткажите пожалуйста, заменяет
    ли плагин WP-Optimize плагины DB-Optimize и Revision Cleaner.\r\n\r\nБольшое спасибо
    за ваши очень полезные статьи."
---
<p><a href="http:&#47;&#47;image.paperplane.su&#47;2012&#47;05&#47;load-on-server.png"><img class="alignleft size-medium wp-image-2500" title="WordPress - нагрузка на сервер" src="http:&#47;&#47;image.paperplane.su&#47;2012&#47;05&#47;load-on-server-300x300.png" alt="WordPress - нагрузка на сервер" width="300" height="300" &#47;><&#47;a>Как правило, блоги под управлением WordPress находятся на шаред хостингах, что накладывает определенные ограничения на ресурсы, которые можно использовать. Это конечно ничего, если посещаемость не ахти, но как только количество уникумов начинает расти и достигает определенной критической точки, при который нагрузка на сервер превышает допустимую шаред хостингом, то обычно аккаунт блокируется. Блокировка, как правило носит, внушительный характер, чтобы веб-мастер хоть что-нибудь предпринял для снижения нагрузки на сервер. Обычно есть два способа борьбы с этим: оплатить более дорогой тариф (обычно покупка VPS), который позволит брать большую нагрузку или оптимизировать работу сайта для снижения нагрузки. Конечно же нам платить больше денег не охота и остается второй вариант - оптимизация. Именно с ней я вам и постараюсь помочь в этом посте, чтобы вы сэкономили свои деньги, хотя бы на время.</p>
<p>Данный мануал написан для оптимизации проектов на основе WordPress, но некоторые моменты подойдут и для любой другой CMS или даже для обычного голого PHP. И не забывайте, что оптимизация поможет не только снижению нагрузки на сервер, но и ускорит загрузку страниц сайта, что соответственно хорошо повлияет на позиции сайта в выдачах поисковиков.</p>
<p>Существует куча различных способов оптимизации работы WordPress, но не все они действенны, удобны и безопасны. Именно по этому в этом мануале я покажу только самые лучшие по моему убеждению способы оптимизации, который не принесут неудобства при дальнейшем использовании WordPress. И вот еще, этот пост &nbsp;своего рода содержание, т.к. тут будет только краткое описание каждого метода, а более подробная информация содержится в смежных постах, в которые вы попадете по ссылкам ниже. Начнем!</p>
<p>Ой, чуть не забыл! Срочно сделайте резервную копию вашего шаблона и вашей базы данных, если ваш хостинг не поддерживает автоматическое резервирование, перед тем как мы начнем. На всякий случай. Если что-то пойдет не так, то будет куда возвращаться.</p>
<p>А начнем мы с того, что установим небольшой код в свой шаблон. Этот код позволит отслеживать <strong><a title="WordPress - количество запросов" href="http:&#47;&#47;paperplane.su&#47;wordpress-kolichestvo-zaprosov&#47;" target="_blank">количество запросов<&#47;a><&#47;strong>&nbsp;(вам по этой ссылке) в базу данных и время их исполнения. Это нам понадобится для контроля качество оптимизации и вообще для интереса.</p>
<p>Мои средние показатели главной страницы перед оптимизацией 86 запросов за 2.3 секунды. Время загрузки главной страницы по версии <a href="http:&#47;&#47;webwait.com&#47;" target="_blank">webwait<&#47;a>&nbsp;3.49 секунд. В принципе показатели и так неплохие, но постараемся их улучшить. Поехали:</p>
<ul>
<li><strong><a title="WordPress - удаление лишних плагинов" href="http:&#47;&#47;paperplane.su&#47;wordpress-udalenie-lishnix-plaginov&#47;" target="_blank">Удаление лишних плагинов<&#47;a><&#47;strong>. Сперва необходимо избавиться от лишнего груза&nbsp;тянущего&nbsp;вас на дно. Много плагинов это очень плохо, а если из них часть бесполезна - это еще хуже. Вам нужно сперва хорошенько подумать над тем, что вам нужно, а что нет. После подумать, какие плагины можно заменить обычным кодом, который не так сильно грузит сервер. И только после удаления лишних плагинов можно продолжить оптимизацию.<&#47;li>
<li><strong><a title="WordPress - оптимизация шаблона" href="http:&#47;&#47;paperplane.su&#47;wordpress-optimizaciya-shablona&#47;" target="_blank">Оптимизация шаблона<&#47;a><&#47;strong>. Оптимизация темы WordPress заключается в комплексном подходе по уходу за всем кодом шаблона. Необходимо убрать все функции, которые можно заменить обычным текстом, тем самым снизив нагрузку на сервер и сократив количество запросов в базу данных. Каждая тема имеет такие функции для того, чтобы обеспечить свою встраиваемость и гибкость в любом проекте. Желательно оптимизировать CSS и JavaScript файлы. И что не мало важно, уменьшить размер картинок, которые грузит сервер. По секрету скажу, что плохой шаблон залог тормозного сайта.<&#47;li>
<li><strong><a title="WordPress - очистка и оптимизация базы данных" href="http:&#47;&#47;paperplane.su&#47;wordpress-ochistka-i-optimizaciya-bazy-dannyx&#47;" target="_blank">Очистка и оптимизация базы данных<&#47;a><&#47;strong>. Очень важный шаг, т.к. самое узкое место в любой подобной системе это база данных. Именно работа с ней занимает большую часть времени, потому оптимизация самой базы данных так важна. Ее необходимо почистить от лишних таблиц и лишних записей, а так же провести оптимизацию по внутреннему алгоритму MySQL. Все это не сложно и обычно сводится к выполнению нескольких запросов. В иных случаях размер базы данных можно сократить в два раза и даже больше.<&#47;li>
<li><strong><a title="Блокировка хотлинков" href="http:&#47;&#47;paperplane.su&#47;blokirovka-hotlinks&#47;" target="_blank">Запрет хотлинков<&#47;a><&#47;strong>. Хотлинк - это включение в страницу файлов-изображений или других ресурсов с чужого сервера. Т.е. грубо говоря, это кража ресурсов сервера без вашего ведома. Любой сайт может взять вашу картинку и отобразить у себя на страницах, а это значит при загрузке этой страницы будет обращение к вашему серверу, что займет его время и соответственно отнимет ваши ресурсы в некуда. Это не есть хорошо и с этим нужно бороться.<&#47;li>
<li><strong><a title="WordPress и спам" href="http:&#47;&#47;paperplane.su&#47;wordpress-i-spam&#47;" target="_blank">Забанить спаммеров<&#47;a><&#47;strong>. Постепенно, пока ваш ресурс становится популярным, его внимание привлекают все больше и больше спаммеров, которые шлют вам разные "сладости" тем самым не давая жить спокойно не вам ни вашему серверу. Вы это может и переживете, а вот ваш сервер может отреагировать негативно на тысячи бесполезных обращений, которые крадут его ресурсы. Верным решением было бы запретить таким подключениям инициироваться, но это очень трудная задача в плане определения спаммерского подключения. Тут есть небольшой выход в том, чтобы вручную запретить доступ спаммерам к сайту. Это в принципе возможно, надо только знать кому нужно запретить. Списки такие в инете существуют и не воспользоваться ими было бы страшным преступлением. Так же еще существуют методы, но о них подробнее пойдет речь в отдельной статей (по ссылке выше).<&#47;li>
<li><strong><a title="WordPress - картинки на поддомене" href="http:&#47;&#47;paperplane.su&#47;wordpress-images-subdomain&#47;" target="_blank">Перенос изображений на поддомен<&#47;a><&#47;strong>. Это не совсем снижение нагрузки на сервер, скорее это просто ускорение загрузки сайта. Тут все достаточно просто. Необходимо сделать так, чтобы все картинки хранились на поддомене блога, что позволит загружать их параллельно основному контенту страницы, а не последовательно как это обычно происходит. Данная возможность доступно благодаря умению браузеров грузить страницу в несколько потоков, как они обычно грузят много сайтов одновременно. А поскольку поддомен это фактически отдельный сайт, то в пределах одной страницы это ускоряет загрузку. Но на самом деле так можно грузить любые файлы (например, CSS и JS), а не только картинки, просто обычно на блоге картинки занимают больше всего места, потому первого кого необходимо сбросить на поддомен это их.<&#47;li>
<li><strong><a title="W3 Total Cache настройка" href="http:&#47;&#47;paperplane.su&#47;w3-total-cache-nastrojka&#47;" target="_blank">Устновка плагина кэширования<&#47;a><&#47;strong>. Для WordPress существует приличное количество плагинов кэширования, но лично я рекомендую W3 Total Cache. Он мне больше всех понравился по настраиваемости и производительности. Правда, в силу того, что он имеет богатый функционал его достаточно рутинно настраивать. Именно поэтому я написал вспомогательную статью, где и разобрал весь алгоритм первоначальной настройки.<&#47;li><br />
<&#47;ul><br />
Исполнения этого комплекса мер по ускорению блога (или снижению нагрузки на сервер) может занять не один день, но оно того стоит. У моего блога после этого всего &nbsp;средние показатели главной страницы стали 78 запросов за 2,1 сек., а время загрузки главной страницы по версии <a href="http:&#47;&#47;webwait.com&#47;" target="_blank">webwait<&#47;a>&nbsp;2.98 секунд. На самом деле они конечно скачут, но примерно так. В любом случаи, ускорение загрузки страниц я сам заметил.</p>
<p>Если вы знаете еще какой-нибудь метод ускорения загрузки страниц и снижения нагрузки на сервер, то я бы очень хотел его узнать. Вы можете о нем написать в комментарии. Так же я бы с удовольствием обсудил ваши идеи по этому поводу, может быть совместными усилиями придумаем нечто хорошее. Ну и ваши пожелания и мнения так же пишите в комментарии. Всем стремительной загрузки!</p>
