---
layout: post
status: publish
published: true
title: Настройка git
author:
  display_name: SlowProg
  login: seoadmin
  email: paperplanesu@rambler.ru
  url: http://paperplane.su
author_login: seoadmin
author_email: paperplanesu@rambler.ru
author_url: http://paperplane.su
wordpress_id: 2664
wordpress_url: http://paperplane.su/?p=2664
date: '2014-01-30 01:23:04 +0400'
date_gmt: '2014-01-29 21:23:04 +0400'
categories:
- Мастерская
tags:
- git
- debian
- настройка
comments:
- id: 221796
  author: morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2014-02-01 20:03:38 +0400'
  date_gmt: '2014-02-01 16:03:38 +0400'
  content: "Внесу и свои две копейки :)\r\n\r\nОчень полезен общий файл для настроек
    игнорирования. Замечаю, что не все им пользуются, и копируют из проекта в проект
    в gitignore одно и то же: composer.phar, служебные папки IDE (.idea, .netbeens
    и прочее), мусорные и временные файлы операционной системы и прочее. Однако можно
    использовать вот это - https:&#47;&#47;help.github.com&#47;articles&#47;ignoring-files#global-gitignore\r\n\r\nТакже
    не нужно изобретать велосипедов с веткой в командной строке и с автодополнением
    гитовских команд, всё уже есть в официальной поставке, так сказать. Нужные скрипты
    находятся тут - https:&#47;&#47;github.com&#47;git&#47;git&#47;tree&#47;master&#47;contrib&#47;completion
    - инструкция по установке в самих файлах."
- id: 221817
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2014-02-01 22:13:39 +0400'
  date_gmt: '2014-02-01 18:13:39 +0400'
  content: Отличные копейки! А я и не знал про "официальную поставку". Прям стыдно.
    Век живи - век учись. Спасибо =)
- id: 222409
  author: morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2014-02-04 00:58:20 +0400'
  date_gmt: '2014-02-03 20:58:20 +0400'
  content: Странно, уведомление мне так и не пришло на почту об ответе. И в спаме
    нету.
- id: 222414
  author: morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2014-02-04 01:07:54 +0400'
  date_gmt: '2014-02-03 21:07:54 +0400'
  content: Я тоже не знал, но видел это в своём виндовом msysgit, а совсем недавно
    вдруг задумался - не из воздуха же это берётся. И начал копаться в его (msysgit)
    файлах, пока не раскопал :)
- id: 227905
  author: morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2014-03-27 02:31:24 +0400'
  date_gmt: '2014-03-26 22:31:24 +0400'
  content: "Ошибка вскрылась:\r\n<code>git config --global credential.helper \"cache
    --timeout = 3600\"<&#47;code>\r\n\r\nНужно:\r\n<code>git config --global credential.helper
    \"cache --timeout=3600\"<&#47;code>\r\n\r\nА то опцию схавать не может :)"
- id: 227907
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2014-03-27 02:34:20 +0400'
  date_gmt: '2014-03-26 22:34:20 +0400'
  content: Вот спасибо! Всё поправил!
- id: 228096
  author: morontt
  author_email: morontt@gmail.com
  author_url: http://morontt.info
  date: '2014-03-30 20:58:20 +0400'
  date_gmt: '2014-03-30 16:58:20 +0400'
  content: Опять нет уведомления об ответе на почте. Раньше были. У тебя тут ничего
    не сломалось?
- id: 228099
  author: SlowProg
  author_email: paperplanesu@rambler.ru
  author_url: http://paperplane.su
  date: '2014-03-30 22:21:09 +0400'
  date_gmt: '2014-03-30 18:21:09 +0400'
  content: блин. что такое? я только сейчас случайно заметил твой ответ. походу что-то
    не так. о твоём ответе не оповещалось. хотя другие комментаторы оповещаются. надо
    подумать будет над этим. руки у меня не доходят до блога. хотел бы его перелопатить
    всего. но как-то не хочу заморачиваться, а то если начну дык увязну по уши.
---
Доброе время суток. Давно хотел заикнуться про git, но как-то времени не было. И вот решил начать с самого начала: с настройки git. По идеи, после установки уже можно начинать работать с этой системой управления версиями без каких либо особых телодвижений. Но многие даже и не подозревают (или подозревают, но ленятся) насколько удобней будет работать с git'ом, если предварительно его немного помучать. Никаких хитрых действий не требуется, просто не все знают, что git может сделать работу ещё проще. И именно об этом я и постараюсь вам рассказать. Приступим.</p>
<p>Допустим, вы только что <a href="http:&#47;&#47;paperplane.su&#47;nginx-php-fpm-debian&#47;" title="Установка nginx и PHP-FPM на Debian" target="_blank">установили nginx на свой Debian<&#47;a> и хотите приступить к разработке очередного проекта, но перед этим очень хотели бы поддержать версированность проекта и атомизировать все изменения (надо быть проще, ну и слова!). Тут на помощь приходит <strong>GIT<&#47;strong>; установить его просто:<br />
[cce_bash]<br />
apt-get install git<br />
[&#47;cce_bash]<br />
После этого можно сразу приступать к конфигурированию свежеиспечённого пакета. Но прошу обратить внимание, что у каждого пользователя системы могут быть свои конфигурации git'а, потому вносите все настройки из-под того пользователя для кого и настраиваете, а не из-под root.</p>
<h2>Обязательные настройки git<&#47;h2><br />
Перед началом работы нужно обязательно указать автора будущих коммитов и его электронную почту. Делается это просто двумя командами:<br />
[cce_bash]<br />
git config --global user.name "Ivan Petrov"<br />
git config --global user.email ivan_petrov@paperplane.su<br />
[&#47;cce_bash]<br />
Это необходимо для того, чтобы возможно было найти автора того или иного коммита. При просмотре лога репозитория для каждого коммита указанно кто его сделал (name) и как его найти (email). Потому настоятельно рекомендую указывать реальные данные, чтобы вы не потерялись и вас смогли найти в случае чего. И обратите внимание, что менять эту информацию во время разработки проекта крайне нежелательно, поскольку может поломаться история и у проекта будут множественные авторы. Рекомендую хорошенько подумать и выбрать раз и на всегда одно имя и мыло.</p>
<h2>Кастомные настройки git<&#47;h2><br />
Всё что пойдёт дальше уже не является обязательным для работы git. После внесения имени и мыла можно полноценно использовать все его возможности, но у нас есть возможность сделать работу с git удобнее и быстрее.</p>
<h3>Редактор по умолчанию<&#47;h3><br />
Для коммитов желательно указывать комментарии, иногда комментарий может быть большой и удобнее его набрать в редакторе. Обычно git использует стандартный редактор вашей системы: vi или vim. Не все его любят, потому есть возможность сменить редактор на любой другой, например, на <em>nano<&#47;em>:<br />
[cce_bash]<br />
git config --global core.editor nano<br />
[&#47;cce_bash]</p>
<h3>Цвета вывода команд<&#47;h3></p>
<p>Git умеет раскрашивать вывод своих команд в терминале, что может помочь быстрее и легче визуально анализировать текст. Настройка цветов и форматирования вывода довольно гибкая, что позволит сделать весь вывод полностью на ваш вкус и цвет. Но если вы доверяете дефолтовому вкусу и цвету, то можете просто выполнить следующую команду:</p>
<p>[cce_bash]<br />
git config --global color.ui true<br />
[&#47;cce_bash]</p>
<p>В случае, если стандартные цвета заставляют течь кровь из ваших глаз, то вы можете задать настройки цветов для каждой команды (<em>branch<&#47;em>, <em>diff<&#47;em>, <em>interactive<&#47;em>, <em>status<&#47;em>) отдельно и даже для отдельных частей вывода команды. Например, чтобы получить метаинформацию в выводе команды diff в синем цвете с чёрным фоном и жирным шрифтом, выполните следующую команду:</p>
<p>[cce_bash]<br />
git config --global color.diff.meta "blue black bold"<br />
[&#47;cce_bash]</p>
<p>При этом цвета могут быть следующие: <em>normal<&#47;em>, <em>black<&#47;em>, <em>red<&#47;em>, <em>green<&#47;em>, <em>yellow<&#47;em>, <em>blue<&#47;em>, <em>magenta<&#47;em>, <em>cyan<&#47;em> и <em>white<&#47;em>. А стили оформления: <em>bold<&#47;em>, <em>dim<&#47;em>, <em>ul<&#47;em>, <em>blink<&#47;em> и <em>reverse<&#47;em>. Богато!</p>
<p>Все поднастройки я перечислять тут не буду, но вы можете прочитать про них в мане по настройке git (в терминале [cci_bash]man git config[&#47;cci_bash]). В руководстве ищите раздел <em>Variables<&#47;em>, а в нём параметры <em>color<&#47;em>.</p>
<h3>Кеширование пароля<&#47;h3></p>
<p>Иногда за раз нужно выполнить несколько операций с удаленным репозиторием к ряду. И при этом каждый раз для каждой команды вы будете набирать имя и пароль. Это может утомить. И поэтому существует возможность закешировать пароль на небольшое время, чтобы система держала его в памяти и после первого ввода уже вас о нём не спрашивала. Чтобы установить эту настройку нужно ввести следующую команду:</p>
<p>[cce_bash]<br />
git config --global credential.helper "cache --timeout=3600"<br />
[&#47;cce_bash]</p>
<p>Соответственно, время задаётся в секундах и 3600 секунд &ndash; это один час. Т.е. на протяжении часа после первого ввода пароля git не будет более его просить.</p>
<h3>Алиасы для команд<&#47;h3><br />
Для каждой команды в git можно установить краткое написани (алиасы), чтобы экономить время при их вводе. Кажется, что вещь бесполезная, но когда начинаешь активно пользоваться git'ом, то польза на лицо.</p>
<p>Алиасы можно устанавливать в самом git, например, вот несколько примеров:</p>
<p>[cce_bash]<br />
git config --global alias.co checkout<br />
git config --global alias.ci commit<br />
git config --global alias.st status<br />
git config --global alias.br branch<br />
[&#47;cce_bash]</p>
<p>Соответственно, каждому из выше перечисленных алиасу будут соответствовать следующие команды:</p>
<p>[cce_bash]<br />
git co<br />
git ci<br />
git st<br />
git br<br />
[&#47;cce_bash]</p>
<p>Коротко, но не достаточно коротко! Устанавливая алиасы на уровне git'а вам всегда придётся писать вначале <em>git<&#47;em>, а потом сам алиас. Очень плохо. Если ваша операционная система поддерживает алиасы или шорткаты, то лучше установить их на этом уровне. Например, в Debian можно добавить алиасы в конец файла <em>~&#47;.profile<&#47;em>:</p>
<p>[cce_bash]<br />
alias gs='git status '<br />
alias ga='git add '<br />
alias gb='git branch '<br />
alias gc='git commit'<br />
alias gd='git diff'<br />
alias go='git checkout '<br />
alias gl='git log --graph --abbrev-commit --decorate --date=relative --format=format:"%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%s%C(reset) %C(dim white)- %an%C(reset)%C(bold yellow)%d%C(reset)" --all'<br />
[&#47;cce_bash]</p>
<p>Теперь все команды пишутся в два символа, что не может не радовать. Только не забудьте перезапустить терминал после внесение алсиасов.</p>
<blockquote><p><strong>Для справки<&#47;strong>. Все конфигурации, что были внесены командой [cci_bash]git config[&#47;cci_bash] записываются в файл <em>.gitconfig<&#47;em>, который находиться в вашей домашней директории. Вы можете его открыть в любом текстовом редакторе (например, [cci_bash]nano ~&#47;.gitconfig[&#47;cci_bash]) и править напрямую без использования команды.<&#47;blockquote></p>
<h3>Название ветки в консоли<&#47;h3></p>
<p>Переключаясь между различными ветками репозитория можно запутаться и забыть в какой находишься, но можно сделать так, чтобы название активной ветки всегда отображалось прямо в консоле. Выглядеть это будет примерно следующим образом:</p>
<p>[cce_bash]<br />
user@server:~&#47;rep[develop]$<br />
[&#47;cce_bash]</p>
<p>Чтобы это реализовать нужно добавить следующий код в конец файла <em>~&#47;.profile<&#47;em>:</p>
<p>[cce_bash]<br />
parse_git_branch() {<br />
	if ! git rev-parse --git-dir > &#47;dev&#47;null 2>&1; then<br />
		return 0<br />
	fi<br />
	git_branch=$(git branch 2>&#47;dev&#47;null| sed -n '&#47;^\*&#47;s&#47;^\* &#47;&#47;p')<br />
	echo "[$git_branch]"<br />
}<br />
PS1="${debian_chroot:+($debian_chroot)}\[\033[01;36m\]\u@\h\[\033[00m\]:\[\033[01;32m\]\w\[\033[00m\]\[\033[01;31m\]\$(parse_git_branch)\[\033[00m\]$ "<br />
[&#47;cce_bash]<br />
Не забудьте перезапустить терминал, чтобы изменения вступили в силу.</p>
<p>Эта фича была стянута <a rel="nofollow" href="http:&#47;&#47;subhojitpaul.blogspot.ru&#47;2013&#47;03&#47;display-current-git-branch-in-bash.html" target="_blank">отсюда<&#47;a>, потому если будут вопросы, то к автору. Но вообще, для этого используется переменная окружения PS1, которая и отвечает за внешний вид консоли. И в принципе, туда можно что угодно намешать. Подробнее об этом можно почитать <a rel="nofollow" href="http:&#47;&#47;www.cyberciti.biz&#47;tips&#47;howto-linux-unix-bash-shell-setup-prompt.html" target="_blank">тут<&#47;a>.</p>
<h2>Заключение<&#47;h2><br />
Теперь работа с git станет ещё приятнее и лаконичнее, а ваша продуктивность поднимется на новый уровень. Но, если вы ещё плохо разбираетесь в этом, то вам нужно полистать соответствующую литературу. Я могу порекомендовать два варианта:</p>
<ul>
<li><a rel="nofollow" href="http:&#47;&#47;githowto.com&#47;ru" title="Git How To" target="_blank">Git How To<&#47;a> &ndash; это интерактивный тур, который познакомит вас с основами Git. Он весь на русском языке, потому его освоение не должно вызвать затруднение.<&#47;li>
<li><a rel="nofollow" href="https:&#47;&#47;www.codeschool.com&#47;courses&#47;try-git" title="Try Git" target="_blank">Try Git<&#47;a> &ndash; курс обучения владением git в небезызвестной школе <em>CodeSchool<&#47;em>. В этом курсе вы будете выполнять задания, что позволит быстро обучиться основным премудростям, но правда, там всё на английском.<&#47;li><br />
<&#47;ul></p>
<p>Если вы хотите увидеть простой пример рабочего процесса над проектом с помощью git, то рекомендую почитать <a href="http:&#47;&#47;www.gnuplanet.ru&#47;doc&#47;dev&#47;tool&#47;git&#47;" title="Git это просто!" target="_blank">эту статью<&#47;a>.</p>
<p>На этом у меня всё. Надеюсь вам была полезна эта статья. С любыми вопросами, пожеланиями или предложениями в комментарии. Всем удачи и отсутствия коллизий!</p>
